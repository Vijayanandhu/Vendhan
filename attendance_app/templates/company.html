{% extends "base.html" %}
{% block title %}{{ company_name or 'Company Details' }}{% endblock %}
{% block content %}
<div class="form-container">
    <h2 class="form-title">
        <i class="fas fa-building"></i>
        Company Details
    </h2>
    
    {% if company and company.logo %}
    <div class="current-logo-section">
        <h4>Current Logo:</h4>
        <img src="{{ url_for('static', filename='uploads/' + company.logo) }}" alt="Current Company Logo" class="current-logo-preview">
    </div>
    {% endif %}
    
    <form method="POST" enctype="multipart/form-data">
        {{ form.hidden_tag() }}  {# This includes the CSRF token #}
        
        <div class="form-group">
            <label class="form-label">
                <i class="fas fa-tag"></i> Company Name
            </label>
            <input type="text" name="name" class="form-control" 
                   value="{{ company.name if company else '' }}" 
                   placeholder="Enter your company name" required>
        </div>
        
        <div class="form-group">
            <label class="form-label">
                <i class="fas fa-map-marker-alt"></i> Address
            </label>
            <textarea name="address" class="form-control" rows="3" 
                      placeholder="Enter company address" required>{{ company.address if company else '' }}</textarea>
        </div>
        
        <div class="form-group">
            <label class="form-label">
                <i class="fas fa-envelope"></i> Email
            </label>
            <input type="email" name="email" class="form-control" 
                   value="{{ company.email if company else '' }}" 
                   placeholder="company@example.com" required>
        </div>
        
        <div class="form-group">
            <label class="form-label">
                <i class="fas fa-image"></i> Company Logo
            </label>
            <div class="file-upload-wrapper">
                <input type="file" name="logo" id="logo" class="file-input" accept="image/*">
                <label for="logo" class="file-upload-label">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <span>Choose Logo File</span>
                    <small>PNG, JPG, or GIF (max 5MB)</small>
                </label>
                <div class="file-preview" id="logoPreview"></div>
            </div>
        </div>
        
        <div class="form-group">
            <label class="form-label">
                <i class="fas fa-phone"></i> Phone Number
            </label>
            <input type="tel" name="phone" class="form-control" 
                   value="{{ company.phone if company else '' }}" 
                   placeholder="+1 (555) 123-4567">
        </div>
        
        <div class="form-group">
            <label class="form-label">
                <i class="fas fa-globe"></i> Website
            </label>
            <input type="url" name="website" class="form-control" 
                   value="{{ company.website if company else '' }}" 
                   placeholder="https://www.company.com">
        </div>
        
        <div class="button-group">
            <button type="submit" class="btn-primary">
                <i class="fas fa-save"></i> Save Company Details
            </button>
            <a href="{{ url_for('dashboard') }}" class="btn-secondary">
                <i class="fas fa-arrow-left"></i> Back to Dashboard
            </a>
        </div>
    </form>
</div>

<script>
// Logo preview functionality
document.getElementById('logo').addEventListener('change', function(e) {
    const file = e.target.files[0];
    const preview = document.getElementById('logoPreview');
    const label = document.querySelector('.file-upload-label span');
    
    if (file) {
        // Validate file size (5MB limit)
        if (file.size > 5 * 1024 * 1024) {
            alert('File size must be less than 5MB');
            this.value = '';
            return;
        }
        
        // Show file name
        label.textContent = file.name;
        
        // Create preview
        const reader = new FileReader();
        reader.onload = function(e) {
            preview.innerHTML = `
                <div class="logo-preview">
                    <img src="${e.target.result}" alt="Logo Preview">
                    <p>Preview</p>
                </div>
            `;
        };
        reader.readAsDataURL(file);
    } else {
        label.textContent = 'Choose Logo File';
        preview.innerHTML = '';
    }
});
</script>
{% endblock %}
